<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Vibe Music | Premium AI Music Experience</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;500;600;700;800&display=swap"
        rel="stylesheet">
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="analytics.css">
    <link rel="icon" type="image/png" href="assets/logo.png">
    <!-- FontAwesome for Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <!-- SEO Meta Tags -->
    <meta name="description"
        content="Vibe Music - The ultimate AI-powered music player. Experience ad-free streaming, real-time analytics, and high-fidelity audio. Download v0.5.11 Premium Edition now.">
    <meta name="keywords" content="Vibe Music, Music Player, AI Music, Cloud Sync, Ad-Free Music, Android Music App">
    <meta property="og:title" content="Vibe Music | Premium AI Music Experience">
    <meta property="og:description" content="Feel every beat â€” music with soul. Download Vibe Music today.">
    <meta property="og:image" content="assets/logo.png">
</head>

<body>
    <div class="background"></div>
    <div class="overlay"></div>

    <!-- Navigation -->
    <nav class="navbar">
        <div class="nav-brand">
            <img src="assets/logo.png" alt="Logo" class="nav-logo">
            <span>Vibe Music</span>
        </div>
        <div class="nav-links" id="navLinks">
            <a href="#home" onclick="toggleMenu()">Home</a>
            <a href="#advanced-features" onclick="toggleMenu()">Advanced</a>
            <a href="#screens" onclick="toggleMenu()">Gallery</a>
            <a href="VibeMusic_Pro_v0.5.11.apk" class="nav-btn">Download Pro</a>
        </div>
        <div class="menu-btn" onclick="toggleMenu()">
            <i class="fa-solid fa-bars" id="menuIcon"></i>
        </div>
    </nav>

    <!-- Scrolling Background Text (Marquee Effect) -->
    <div class="marquee-wrapper">
        <div class="marquee-content">
            VIBE MUSIC â€¢ FEEL THE BEAT â€¢ SOULFUL MELODIES â€¢ VIBE MUSIC â€¢ FEEL THE BEAT â€¢ SOULFUL MELODIES â€¢
        </div>
        <div class="marquee-content">
            VIBE MUSIC â€¢ FEEL THE BEAT â€¢ SOULFUL MELODIES â€¢ VIBE MUSIC â€¢ FEEL THE BEAT â€¢ SOULFUL MELODIES â€¢
        </div>
    </div>

    <!-- Hero Section -->
    <section id="home" class="hero-section">
        <div class="hero-content">
            <div class="hero-text">
                <div class="badge">V0.5.11 Premium Version</div>
                <h1 class="hero-title">Feel Every Beat <br> <span class="gradient-text">Music with Soul.</span></h1>
                <p class="hero-desc">Vibe hai toh Vibe Music hai, yeh sirf gaane nahi jazbaat hai. Jo sun le ek baar
                    ise, uske dil ke yeh saath hai.</p>
                <div class="hero-btns">
                    <a href="VibeMusic_Pro_v0.5.11.apk" class="download-btn">
                        <i class="fa-brands fa-android"></i> Download Pro Edition
                        <span class="btn-sub">v0.5.11 (Analytics Enabled)</span>
                    </a>
                    <a href="VibeMusic_Ankit_v0.5.11.apk" class="secondary-btn">
                        <i class="fa-solid fa-bolt"></i> ANKIT Special Build
                    </a>
                </div>
                <div class="security-badge">
                    <i class="fa-solid fa-shield-halved"></i>
                    <span>Highly Secure & Verified by Vibe AI</span>
                </div>
                <div class="social-proof">
                    <div class="users">
                        <i class="fa-solid fa-star"></i>
                        <i class="fa-solid fa-star"></i>
                        <i class="fa-solid fa-star"></i>
                        <i class="fa-solid fa-star"></i>
                        <i class="fa-solid fa-star"></i>
                    </div>
                    <span>Loved by music enthusiasts worldwide</span>
                </div>
            </div>
            <div class="hero-visual">
                <div class="phone-frame">
                    <img src="assets/screen1.png" alt="App Screenshot" class="app-screen">
                    <div class="glow-effect"></div>
                </div>
            </div>
        </div>
    </section>

    <!-- Features Grid -->
    <section id="features" class="features-section">
        <h2 class="section-title">Why <span class="gradient-text">Vibe Music?</span></h2>
        <div class="features-grid">
            <div class="feature-card">
                <div class="icon-box"><i class="fa-solid fa-cloud-arrow-up"></i></div>
                <h3>Cloud Sync</h3>
                <p>Seamlessly sync your playlists and favorites across all your devices securely.</p>
            </div>
            <div class="feature-card">
                <div class="icon-box"><i class="fa-solid fa-ban"></i></div>
                <h3>Ad-Free Experience</h3>
                <p>No interruptions. Just pure, unadulterated music bliss, completely free.</p>
            </div>
            <div class="feature-card">
                <div class="icon-box"><i class="fa-solid fa-wand-magic-sparkles"></i></div>
                <h3>AI Recommendations</h3>
                <p>Smart algorithms that understand your taste and curate the perfect vibe for you.</p>
            </div>
            <div class="feature-card">
                <div class="icon-box"><i class="fa-solid fa-sliders"></i></div>
                <h3>High Fidelity</h3>
                <p>Crystal clear audio quality with a built-in advanced equalizer and bass boost.</p>
            </div>
        </div>
    </section>

    <!-- Advanced Features Grid -->
    <section id="advanced-features" class="features-section" style="background: rgba(255, 45, 85, 0.02);">
        <h2 class="section-title">Advanced <span class="gradient-text">Capabilities</span></h2>
        <div class="features-grid">
            <div class="feature-card advanced">
                <div class="icon-box"><i class="fa-solid fa-palette"></i></div>
                <h3>Dynamic Themes</h3>
                <p>14+ curated color palettes that adapt to your style. Experience a new look every day.</p>
            </div>
            <div class="feature-card advanced">
                <div class="icon-box"><i class="fa-solid fa-feather-pointed"></i></div>
                <h3>Vibe Shayeri</h3>
                <p>Integrated poetic universe. Share and copy beautiful shayeris directly from the app.</p>
            </div>
            <div class="feature-card advanced">
                <div class="icon-box"><i class="fa-brands fa-instagram"></i></div>
                <h3>Instagram Stories</h3>
                <p>Let your followers know what you're vibing to with real-time Instagram Stories integration.</p>
            </div>
            <div class="feature-card advanced">
                <div class="icon-box"><i class="fa-solid fa-music"></i></div>
                <h3>Smart Lyrics</h3>
                <p>Real-time, beat-synced lyrics that make every listening session an immersive karaoke experience.</p>
            </div>
        </div>
    </section>

    <!-- Analytics & Map Section -->
    <section class="analytics-section">
        <h2 class="section-title">Global <span class="gradient-text">Impact</span></h2>
        <div class="analytics-container">
            <div class="analytics-data">
                <div class="stat-card">
                    <div class="stat-icon"><i class="fa-solid fa-download"></i></div>
                    <div class="stat-info">
                        <h3 id="installCount">247</h3>
                        <p>Total Installs</p>
                        <span style="font-size: 0.75rem; color: #00ff88; display: block; margin-top: 4px;">ðŸ“ˆ
                            Live</span>
                    </div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon"><i class="fa-solid fa-users-viewfinder"></i></div>
                    <div class="stat-info">
                        <h3 id="activeUserCount">89</h3>
                        <p>Active Listeners</p>
                        <span style="font-size: 0.75rem; color: #00ff88; display: block; margin-top: 4px;">ðŸŽµ Now
                            Playing</span>
                    </div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon"><i class="fa-solid fa-location-dot"></i></div>
                    <div class="stat-info">
                        <h3 id="topRegion">Bihar</h3>
                        <p>Top Region</p>
                        <span style="font-size: 0.75rem; color: #ff6b9d; display: block; margin-top: 4px;">ðŸ”¥
                            Trending</span>
                    </div>
                </div>
            </div>

            <div class="map-visual" id="mapVisual">
                <!-- Points injected by JS -->
            </div>
        </div>
    </section>

    <!-- Shayeri / Updates Section -->
    <section class="vibe-updates-section">
        <h2 class="section-title">Daily <span class="gradient-text">Vibe Check</span></h2>
        <div class="update-card" id="shayeriCard">
            <p class="shayeri-text" id="shayeriText">Vibe hai toh Vibe Music hai, baaki sab sirf shor hai. Yahan har sur
                mein sukoon hai, har beat mein zor hai.</p>
            <button class="refresh-btn" onclick="fetchShayeri()" title="New Vibe"><i
                    class="fa-solid fa-rotate-right"></i></button>
        </div>
    </section>

    <!-- Reviews Section -->
    <section class="reviews-section">
        <h2 class="section-title" id="userStoriesTitle">User <span class="gradient-text">Stories</span></h2>
        <div class="reviews-container" id="reviewsContainer">
            <!-- User feedback will be dynamically loaded here -->
        </div>
        <button class="add-review-btn" onclick="openReviewModal()">Write a Review</button>
    </section>

    <!-- Review Modal -->
    <div class="modal" id="reviewModal">
        <div class="modal-content">
            <h2 style="margin-bottom: 1.5rem;">Rate Vibe Music</h2>
            <div class="form-group">
                <label>Your Name</label>
                <input type="text" id="reviewName" placeholder="Your Name" class="review-input">
            </div>
            <div class="form-group">
                <label>Rating</label>
                <!-- Interactive Star Rating -->
                <div class="rating-input">
                    <input type="hidden" id="reviewRating" value="0">
                    <i class="fa-regular fa-star" data-value="1"></i>
                    <i class="fa-regular fa-star" data-value="2"></i>
                    <i class="fa-regular fa-star" data-value="3"></i>
                    <i class="fa-regular fa-star" data-value="4"></i>
                    <i class="fa-regular fa-star" data-value="5"></i>
                </div>
            </div>
            <div class="form-group">
                <label>Feedback</label>
                <textarea id="reviewText" rows="4" placeholder="Tell us what you think..."></textarea>
            </div>
            <div style="display:flex; gap:1rem;">
                <button class="download-btn" onclick="submitReview()" style="flex:1;">Submit Review</button>
                <button class="secondary-btn" onclick="closeReviewModal()"
                    style="flex:1; text-align:center;">Cancel</button>
            </div>
        </div>
    </div>

    <!-- Screenshots Section -->
    <section id="screens" class="gallery-section">
        <h2 class="section-title">Visual <span class="gradient-text">Perfection</span></h2>
        <div class="gallery-desc">Explore the stunning interface designed for true music lovers.</div>

        <div class="gallery-scroll-container">
            <!-- App Shot 1: Home/Trending -->
            <div class="gallery-item">
                <div class="phone-frame small">
                    <img src="assets/app_shot_1.png" alt="Home Screen" class="app-screen">
                </div>
                <p class="caption">Trending Beats</p>
            </div>

            <!-- App Shot 2: Quick Picks -->
            <div class="gallery-item">
                <div class="phone-frame small">
                    <img src="assets/app_shot_2.png" alt="Quick Picks" class="app-screen">
                </div>
                <p class="caption">Quick Picks & Recommendations</p>
            </div>

            <!-- App Shot 3: Playlist/Queue -->
            <div class="gallery-item">
                <div class="phone-frame small">
                    <img src="assets/app_shot_3.png" alt="Playlist View" class="app-screen">
                </div>
                <p class="caption">Seamless Queue Management</p>
            </div>

            <!-- App Shot 4: Player -->
            <div class="gallery-item">
                <div class="phone-frame small">
                    <img src="assets/screen2.png" alt="Immersive Player" class="app-screen">
                </div>
                <p class="caption">Immersive Player</p>
            </div>

            <!-- App Shot 5: Vibe Shayeri -->
            <div class="gallery-item">
                <div class="phone-frame small">
                    <img src="assets/shayeri_1.jpg" alt="Vibe Shayeri Genres" class="app-screen">
                </div>
                <p class="caption">Vibe Shayeri Universe</p>
            </div>

            <!-- App Shot 6: Celebration Shayeri -->
            <div class="gallery-item">
                <div class="phone-frame small">
                    <img src="assets/shayeri_2.jpg" alt="Shayeri List" class="app-screen">
                </div>
                <p class="caption">Beat-Synced Poetic Lists</p>
            </div>

            <!-- App Shot 7: Settings -->
            <div class="gallery-item">
                <div class="phone-frame small">
                    <img src="assets/shayeri_3.jpg" alt="Settings Screen" class="app-screen">
                </div>
                <p class="caption">Pro Settings & Control</p>
            </div>

            <!-- App Shot 8: Themes -->
            <div class="gallery-item">
                <div class="phone-frame small">
                    <img src="assets/shayeri_4.jpg" alt="Themes Screen" class="app-screen">
                </div>
                <p class="caption">14+ Dynamic Themes</p>
            </div>
        </div>
    </section>

    <!-- Footer / Social -->
    <footer class="footer">
        <div class="footer-content">
            <div class="footer-brand">
                <img src="assets/logo.png" alt="Logo" class="footer-logo">
                <h3>Vibe Music</h3>
                <div class="version-badge">Advanced Edition v0.5.11</div>
            </div>

            <div class="footer-divider"></div>

            <div class="social-links">
                <a href="https://github.com/amitkumar262002" class="social-icon" target="_blank">
                    <i class="fa-brands fa-github"></i>
                    <span>GitHub</span>
                </a>
                <a href="https://www.instagram.com/blood__badshah/" class="social-icon" target="_blank">
                    <i class="fa-brands fa-instagram"></i>
                    <span>Instagram</span>
                </a>
            </div>

            <div class="footer-bottom">
                <p>&copy; 2026 Vibe Music. All rights reserved. <span style="opacity: 0.2; font-size: 0.6rem;">Owner
                        Tip: DBL-CLK User Stories</span></p>
                <p class="credit">Created by <span>Blood Badshah (ANKIT)</span> with <i
                        class="fa-solid fa-heart heartbeat"></i> for Music.</p>
            </div>
        </div>
    </footer>

    <script>
        // Mobile Menu Toggle
        function toggleMenu() {
            const navLinks = document.getElementById('navLinks');
            const menuIcon = document.getElementById('menuIcon');
            navLinks.classList.toggle('active');

            if (navLinks.classList.contains('active')) {
                menuIcon.classList.remove('fa-bars');
                menuIcon.classList.add('fa-xmark');
            } else {
                menuIcon.classList.remove('fa-xmark');
                menuIcon.classList.add('fa-bars');
            }
        }

        // Smooth scroll
        document.querySelectorAll('a[href^="#"]').forEach(anchor => {
            anchor.addEventListener('click', function (e) {
                e.preventDefault();
                document.querySelector(this.getAttribute('href')).scrollIntoView({
                    behavior: 'smooth'
                });
            });
        });

        // Auto-download and Shared Link Handling
        window.onload = function () {
            const urlParams = new URLSearchParams(window.location.search);
            const songId = urlParams.get('v');
            const shouldDownload = urlParams.get('download') === 'true';

            if (songId) {
                // If a song link is shared, show a premium alert
                const announcement = document.createElement('div');
                announcement.className = 'song-share-overlay';
                announcement.innerHTML = `
                    <div class="song-share-card">
                        <i class="fa-solid fa-music song-icon"></i>
                        <h2>Shared Song Detected</h2>
                        <p>Someone shared a track with you! Download <b>Vibe Music</b> to listen to this song with premium AI quality.</p>
                        <a href="VibeMusic_v0.5.10.apk" class="download-btn">
                            <i class="fa-brands fa-android"></i> Download App Now
                        </a>
                        <button onclick="this.parentElement.parentElement.remove()" class="close-overlay">Maybe Later</button>
                    </div>
                `;
                document.body.appendChild(announcement);
            }

            if (shouldDownload) {
                const link = document.createElement('a');
                link.href = 'VibeMusic_v0.5.10.apk';
                link.download = 'VibeMusic_v0.5.10.apk';
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);
            }

            // Initial Data Load
            loadData();
        };

        // --- NEW FEATURES LOGIC ---

        // 1. Fetch Data (Shayeri & Analytics) - Optional
        async function loadData() {
            try {
                const response = await fetch('shayeri.json');
                if (!response.ok) throw new Error('File not found');
                const data = await response.json();

                // Update Shayeri
                if (data.updates && data.updates.length > 0) {
                    window.shayeriData = data.updates;
                    displayRandomShayeri();
                }
            } catch (error) {
                // Fallback shayeri if file not found
                console.log('Using default shayeri');
                const shayeriElem = document.getElementById('shayeriText');
                if (shayeriElem) {
                    shayeriElem.innerText = "Vibe hai toh Vibe Music hai, baaki sab sirf shor hai. Yahan har sur mein sukoon hai, har beat mein zor hai.";
                }
            }
        }

        // --- REAL TIME SIMULATION ---
        function startLiveCounting(baseInstalls, baseActive) {
            let currentInstalls = baseInstalls;
            let currentActive = baseActive;

            const installElem = document.getElementById("installCount");
            const activeElem = document.getElementById("activeUserCount");

            // Random "Active Listener" fluctuation (Like a heartbeat)
            setInterval(() => {
                const change = Math.floor(Math.random() * 5) - 2; // -2 to +2
                currentActive = Math.max(currentActive + change, 0);
                activeElem.innerText = currentActive.toLocaleString() + "+";

                // Trigger map pulse if active increases
                if (change > 0) {
                    pulseRandomMapPoint();
                }
            }, 3000); // Update every 3 seconds

            // Random "New Installs" (Happens less often but only goes UP)
            setInterval(() => {
                if (Math.random() > 0.6) { // 40% chance every check
                    currentInstalls += 1;
                    installElem.innerText = currentInstalls.toLocaleString() + "+";

                    // Show visual feedback
                    installElem.style.color = '#00ffcc';
                    setTimeout(() => installElem.style.color = '', 500);
                }
            }, 8000); // Check every 8 seconds
        }

        function pulseRandomMapPoint() {
            const points = document.getElementsByClassName('map-point');
            if (points.length > 0) {
                const randomPoint = points[Math.floor(Math.random() * points.length)];
                randomPoint.style.transform = "scale(1.8)";
                randomPoint.style.boxShadow = "0 0 30px #ff00cc";
                setTimeout(() => {
                    randomPoint.style.transform = "scale(1)";
                    randomPoint.style.boxShadow = "";
                }, 500);
            }
        }

        function displayRandomShayeri() {
            if (!window.shayeriData) return;
            const randomItem = window.shayeriData[Math.floor(Math.random() * window.shayeriData.length)];
            const textElement = document.getElementById('shayeriText');

            // Security: Strip trailing #numbers just in case
            const cleanText = randomItem.content.replace(/\s*#\s*\d+$/, '').trim();

            textElement.style.opacity = 0;
            setTimeout(() => {
                textElement.innerText = cleanText;
                textElement.style.opacity = 1;
            }, 300);
        }

        function fetchShayeri() {
            displayRandomShayeri();
        }

        // 2. Render Map Points
        function renderMap(regions) {
            const mapContainer = document.getElementById('mapVisual');
            mapContainer.innerHTML = ''; // Clear

            regions.forEach((region, index) => {
                const point = document.createElement('div');
                point.className = 'map-point';
                point.style.top = region.top;
                point.style.left = region.left;
                point.style.animationDelay = `${index * 0.5}s`; // Staggered pulses
                point.setAttribute('data-city', `${region.name}: ${region.users} Live Users`);
                mapContainer.appendChild(point);
            });

            // Add visual text indicating simulated live activity
            const liveTag = document.createElement('div');
            liveTag.style.position = 'absolute';
            liveTag.style.bottom = '20px';
            liveTag.style.right = '20px';
            liveTag.style.background = 'rgba(0,0,0,0.7)';
            liveTag.style.padding = '5px 10px';
            liveTag.style.borderRadius = '50px';
            liveTag.style.fontSize = '0.8rem';
            liveTag.style.color = '#ff2d55';
            liveTag.style.border = '1px solid rgba(255, 45, 85, 0.3)';
            liveTag.style.display = 'flex';
            liveTag.style.alignItems = 'center';
            liveTag.style.gap = '8px';

            liveTag.innerHTML = `
                <span style="width: 8px; height: 8px; background: #ff2d55; border-radius: 50%; box-shadow: 0 0 10px #ff2d55; animation: blink 1s infinite;"></span> 
                LIVE ACTIVITY (INDIA)
            `;

            mapContainer.appendChild(liveTag);
        }

        // 3. Counter Animation (Initial Load)
        function animateValue(id, start, end, duration) {
            const obj = document.getElementById(id);
            if (!obj) return;
            let startTimestamp = null;
            const step = (timestamp) => {
                if (!startTimestamp) startTimestamp = timestamp;
                const progress = Math.min((timestamp - startTimestamp) / duration, 1);
                obj.innerText = Math.floor(progress * (end - start) + start).toLocaleString() + "+";
                if (progress < 1) {
                    window.requestAnimationFrame(step);
                }
            };
            window.requestAnimationFrame(step);
        }

        // 4. Review System
        function openReviewModal() {
            document.getElementById('reviewModal').style.display = 'flex';
            // Reset form
            currentRating = 0;
            document.getElementById('reviewName').value = '';
            document.getElementById('reviewText').value = '';
            document.getElementById('reviewRating').value = '0';
            // Initialize stars
            initializeStars();
            updateStarVisuals(0);
        }

        function closeReviewModal() {
            document.getElementById('reviewModal').style.display = 'none';
        }

        // --- REVIEW SYSTEM LOGIC ---

        // Setup Interactive Stars
        let currentRating = 0;
        let starInputs = [];

        // On Load: Load reviews from LocalStorage
        loadReviews();
        checkAdmin();

        // Initialize stars after DOM is ready
        function initializeStars() {
            starInputs = document.querySelectorAll('.rating-input i');

            // Apply visual logic to star elements
            starInputs.forEach(star => {
                star.onclick = function () {
                    currentRating = parseInt(this.getAttribute('data-value'));
                    document.getElementById('reviewRating').value = currentRating;
                    updateStarVisuals(currentRating);
                    // Visual feedback pop
                    this.style.transform = 'scale(1.5)';
                    setTimeout(() => this.style.transform = 'scale(1.2)', 100);
                };

                // Hover effect
                star.onmouseenter = function () {
                    const val = parseInt(this.getAttribute('data-value'));
                    updateStarVisuals(val);
                };

                star.onmouseleave = function () {
                    updateStarVisuals(currentRating);
                };
            });
        }

        function updateStarVisuals(rating) {
            starInputs.forEach(star => {
                const val = parseInt(star.getAttribute('data-value'));
                if (val <= rating) {
                    star.classList.add('active');
                    star.classList.remove('fa-regular');
                    star.classList.add('fa-solid');
                    star.style.color = '#ffd700'; // Force color
                } else {
                    star.classList.remove('active');
                    star.classList.remove('fa-solid');
                    star.classList.add('fa-regular');
                    star.style.color = '#888'; // Force default color
                }
            });
        }

        function submitReview() {
            const name = document.getElementById('reviewName').value.trim();
            const text = document.getElementById('reviewText').value.trim();
            const rating = currentRating;

            if (!name || !text || rating === 0) {
                showToast("âš ï¸ Sabhi fields bharna zaroori hai!");
                return;
            }

            // Security Check (Hindi/English abuse filter)
            const badWords = ["bhosdi", "madarchod", "madharchod", "baap", "mc", "bc", "chutiya", "kutta", "randi", "gandu", "haram", "bhosdi", "madarchod", "madharchod", "madhatrchod", "baap", "mc", "bc", "chutiya", "kutta", "kamina", "saala", "stupid", "idiot", "fake", "bekar", "randi", "gandu", "fuck", "shit", "bitch", "scam", "useless", "bakwas", "teri maa ki chut", "bihar ka kutta", "madarchod", "bhosdiwale", "bhosdike", "bhosdike madarchod", "chhakka", "chhakke", "chhakke madarchod", "chhakke madarchod randi", "teri bahenchod", "teri bahenchod randi", "teri bahenchod randi madarchod", 'loude',];
            if (badWords.some(word => text.toLowerCase().includes(word) || name.toLowerCase().includes(word))) {
                alert("ðŸš« Security Alert: Vibe AI detected negative energy. Tera baap hu, tameez se baat kar! ðŸš«");
                return;
            }

            // Create Review Object
            const review = {
                id: Date.now(),
                name: name,
                rating: rating,
                text: text,
                timestamp: Date.now(),
                dateStr: new Date().toLocaleDateString('en-US', { year: 'numeric', month: 'short', day: 'numeric' })
            };

            // Save to LocalStorage
            let reviews = JSON.parse(localStorage.getItem('vibe_reviews') || '[]');
            reviews.unshift(review);
            localStorage.setItem('vibe_reviews', JSON.stringify(reviews));

            // Feedback and Refresh
            if (rating >= 4) launchFireworks();

            closeReviewModal();
            document.getElementById('reviewName').value = '';
            document.getElementById('reviewText').value = '';

            loadReviews(); // This updates the screen with your new feedback
            showToast("ðŸš€ Feedback Published! Aapki story live hai.");

            // Scroll to the new review smoothly
            setTimeout(() => {
                const firstReview = document.querySelector('#reviewsContainer .review-card');
                if (firstReview) firstReview.scrollIntoView({ behavior: 'smooth', block: 'center' });
            }, 500);
        }

        function saveReview(review) {
            let reviews = JSON.parse(localStorage.getItem('vibe_reviews') || '[]');
            reviews.unshift(review); // Add to top
            localStorage.setItem('vibe_reviews', JSON.stringify(reviews));
        }

        function loadReviews() {
            const container = document.getElementById('reviewsContainer');
            container.innerHTML = ''; // Request clear

            let reviews = JSON.parse(localStorage.getItem('vibe_reviews') || '[]');

            // Filter: Only show last 72 Hours (3 days)
            const now = Date.now();
            const validReviews = reviews.filter(r => (now - r.timestamp) < 72 * 60 * 60 * 1000);

            // Update Storage if cleanup happened
            if (reviews.length !== validReviews.length) {
                localStorage.setItem('vibe_reviews', JSON.stringify(validReviews));
            }

            // Update Stats Dashboard
            updateStats(validReviews);

            validReviews.forEach(r => {
                const card = createReviewCard(r);
                container.appendChild(card);
            });
        }

        function createReviewCard(r) {
            const card = document.createElement('div');
            card.className = 'review-card';
            card.dataset.id = r.id;

            let starsHtml = '';
            for (let i = 0; i < 5; i++) {
                starsHtml += (i < r.rating)
                    ? '<i class="fa-solid fa-star" style="color: #ffd700; text-shadow: 0 0 5px #ffd700;"></i>'
                    : '<i class="fa-regular fa-star" style="color: #555;"></i>';
            }

            // Check if owner mode is active
            const isOwnerMode = localStorage.getItem('vibe_owner_mode') === 'true';
            const adminControlsDisplay = isOwnerMode ? 'flex' : 'none';

            card.innerHTML = `
                <div class="admin-controls" style="position: absolute; top: 10px; right: 10px; display: ${adminControlsDisplay}; gap: 8px;">
                    <button class="delete-btn" onclick="editReview(${r.id})" style="background: rgba(0, 255, 204, 0.1); color: #00ffcc; border:none; padding:8px; border-radius:8px; cursor:pointer;" title="Edit Review"><i class="fa-solid fa-pen"></i></button>
                    <button class="delete-btn" onclick="deleteReview(${r.id})" style="background: rgba(255, 0, 0, 0.1); color: #ff3333; border:none; padding:8px; border-radius:8px; cursor:pointer;" title="Delete Review"><i class="fa-solid fa-trash"></i></button>
                </div>
                <div class="reviewer-profile">
                    <div class="reviewer-img" style="background: linear-gradient(135deg, #FF0055, #FF00CC); box-shadow: 0 0 10px rgba(255, 0, 85, 0.5);">${r.name.charAt(0).toUpperCase()}</div>
                    <div class="reviewer-info">
                        <h4 style="display: flex; align-items: center; gap: 5px;">
                            ${r.name} 
                            <i class="fa-solid fa-circle-check" style="color: #00ffcc; font-size: 0.8rem;" title="Verified Vibe User"></i>
                        </h4>
                        <div class="stars">${starsHtml}</div>
                    </div>
                </div>
                <p class="review-text" style="font-size: 1rem; color: #eee; white-space: pre-wrap;">"${r.text}"</p>
                <div style="margin-top: 15px; display: flex; justify-content: space-between; align-items: center;">
                    <span class="review-date" style="color: rgba(255,255,255,0.4); font-size: 0.8rem;">${r.dateStr}</span>
                    <span style="font-size: 0.8rem; color: #00ffcc; background: rgba(0, 255, 204, 0.1); padding: 2px 8px; border-radius: 4px;">Verified Review</span>
                </div>
            `;
            return card;
        }

        window.editReview = function (id) {
            let reviews = JSON.parse(localStorage.getItem('vibe_reviews') || '[]');
            const index = reviews.findIndex(rev => rev.id === id);
            if (index === -1) return;

            const newText = prompt("Owner Action: Edit Review Text", reviews[index].text);
            if (newText !== null && newText.trim() !== "") {
                reviews[index].text = newText.trim();
                localStorage.setItem('vibe_reviews', JSON.stringify(reviews));
                loadReviews();
                showToast("âœ… Review Updated");
            }
        };

        // --- ADMIN CONTROLS ---
        function checkAdmin() {
            // Method 1: Click on the "User Feedback" Title for Hidden Access
            const title = document.getElementById('userStoriesTitle');
            if (title) {
                title.style.cursor = 'pointer';
                title.ondblclick = () => {
                    triggerAdminLogin();
                };
                // Extra hint for owner
                title.title = "Owner Access Click";
            }

            // Method 2: Visible Link in Footer
            if (!document.getElementById('adminLinkBtn')) {
                const footer = document.querySelector('footer');
                if (footer) {
                    const link = document.createElement('a');
                    link.id = 'adminLinkBtn';
                    link.innerText = 'Admin Access';
                    link.style.color = '#555';
                    link.style.textDecoration = 'none';
                    link.style.fontSize = '0.8rem';
                    link.style.marginLeft = '20px';
                    link.style.cursor = 'pointer';
                    link.onclick = (e) => {
                        e.preventDefault();
                        triggerAdminLogin();
                    };
                    footer.appendChild(link);
                }
            }
        }

        function triggerAdminLogin() {
            const password = prompt("Owner Verification: Enter Passcode");
            if (password === "vibeowner2026") {
                enableAdminMode();
                showToast("ðŸ›¡ï¸ Owner Mode Active!");
            } else if (password !== null && password !== "") {
                alert("Access Denied");
            }
        }

        function enableAdminMode() {
            document.body.classList.add('admin-mode');
            localStorage.setItem('vibe_owner_mode', 'true');
            loadReviews(); // Refresh to show admin controls
            const controls = document.querySelectorAll('.admin-controls');
            controls.forEach(ctrl => ctrl.style.display = 'flex');

            // Inject Styles dynamically to show delete buttons
            const style = document.createElement('style');
            style.innerHTML = `.admin-mode .delete-btn { display: block !important; } .admin-mode .admin-badge { display: block !important; }`;
            document.head.appendChild(style);

            const badge = document.createElement('div');
            badge.className = 'admin-badge';
            badge.innerText = 'ðŸ›¡ï¸ OWNER MODE ACTIVE';
            document.body.appendChild(badge);
            showToast("Welcome Owner! You can now manage feedback.");
        }

        window.deleteReview = function (id) {
            if (!confirm("Owner Action: Delete this review permanently?")) return;

            let reviews = JSON.parse(localStorage.getItem('vibe_reviews') || '[]');
            reviews = reviews.filter(r => r.id !== id);
            localStorage.setItem('vibe_reviews', JSON.stringify(reviews));
            loadReviews(); // Refresh UI
        };

        function updateStats(reviews) {
            // Calculate Counts
            const total = reviews.length + 1240; // Fake base to look popular
            const totalStars = reviews.reduce((acc, r) => acc + r.rating, 0) + (1240 * 4.8);
            const avg = (totalStars / total).toFixed(1);

            // Only update if elements exist
            const avgRatingElem = document.getElementById('avgRating');
            const totalRatingCountElem = document.getElementById('totalRatingCount');

            if (avgRatingElem) avgRatingElem.innerText = avg;
            if (totalRatingCountElem) totalRatingCountElem.innerText = total.toLocaleString() + " ratings";

            // Calculate Bars (Simulated + Real)
            const counts = [0, 0, 0, 0, 0, 0]; // Index 1-5
            reviews.forEach(r => counts[r.rating]++);

            // Add fake base data distribution
            counts[5] += 900;
            counts[4] += 200;
            counts[3] += 100;
            counts[2] += 30;
            counts[1] += 10;

            const max = Math.max(...counts.slice(1));

            for (let i = 1; i <= 5; i++) {
                const bar = document.getElementById(`bar-${i}`);
                if (bar) {
                    const width = (counts[i] / max) * 100;
                    bar.style.width = `${width}%`;
                }
            }
        }

        function launchFireworks() {
            // Simple visual confetti/firework effect using CSS classes on body temporarily
            const fireworkContainer = document.createElement('div');
            fireworkContainer.style.position = 'fixed';
            fireworkContainer.style.top = '0';
            fireworkContainer.style.left = '0';
            fireworkContainer.style.width = '100%';
            fireworkContainer.style.height = '100%';
            fireworkContainer.style.pointerEvents = 'none';
            fireworkContainer.style.zIndex = '9999';
            fireworkContainer.innerHTML = `
                <div style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); font-size: 5rem; animation: popUp 1s ease-out forwards;">ðŸŽ‰</div>
                <div style="position: absolute; top: 30%; left: 20%; font-size: 3rem; animation: popUp 0.8s ease-out 0.2s forwards;">âœ¨</div>
                <div style="position: absolute; top: 40%; left: 80%; font-size: 3rem; animation: popUp 0.8s ease-out 0.4s forwards;">ðŸš€</div>
            `;
            document.body.appendChild(fireworkContainer);

            // Add keyframes if not exists (in style tag)
            if (!document.getElementById('animStyles')) {
                const style = document.createElement('style');
                style.id = 'animStyles';
                style.innerHTML = `
                 @keyframes popUp {
                    0% { transform: translate(-50%, -50%) scale(0); opacity: 0; }
                    50% { transform: translate(-50%, -50%) scale(1.5); opacity: 1; }
                    100% { transform: translate(-50%, -50%) scale(2); opacity: 0; }
                 }
                 @keyframes slideIn {
                    from { opacity: 0; transform: translateY(20px); }
                    to { opacity: 1; transform: translateY(0); }
                 }
               `;
                document.head.appendChild(style);
            }

            setTimeout(() => fireworkContainer.remove(), 2000);
        }

        function showToast(msg) {
            const toast = document.createElement('div');
            toast.textContent = msg;
            toast.style.position = 'fixed';
            toast.style.bottom = '20px';
            toast.style.left = '50%';
            toast.style.transform = 'translateX(-50%)';
            toast.style.background = '#00ffcc';
            toast.style.color = '#000';
            toast.style.padding = '10px 20px';
            toast.style.borderRadius = '50px';
            toast.style.fontWeight = 'bold';
            toast.style.boxShadow = '0 0 20px rgba(0, 255, 204, 0.5)';
            toast.style.zIndex = '10000';
            toast.style.animation = 'slideIn 0.3s';

            document.body.appendChild(toast);
            setTimeout(() => {
                toast.style.opacity = '0';
                setTimeout(() => toast.remove(), 300);
            }, 3000);
        }

        // Close modal if clicked outside
        window.onclick = function (event) {
            const modal = document.getElementById('reviewModal');
            if (event.target == modal) {
                closeReviewModal();
            }
        }
    </script>
    <script src="live-analytics.js" type="module"></script>
</body>

</html>